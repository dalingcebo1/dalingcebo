# Image Optimization Guide

This guide explains how to optimize images for the Dalingcebo Art Shop.

## Current Setup

The app uses Next.js Image component which automatically:
- Resizes images on-demand
- Serves modern formats (AVIF, WebP)
- Lazy loads images
- Prevents Cumulative Layout Shift (CLS)

## Image Formats

### Recommended Formats

1. **AVIF** (Best compression, modern browsers)
2. **WebP** (Good compression, wide support)
3. **JPEG** (Fallback for older browsers)

### Configuration

Already configured in `next.config.ts`:
```typescript
images: {
  formats: ['image/avif', 'image/webp'],
  remotePatterns: [
    {
      protocol: 'https',
      hostname: '**.supabase.co',
    },
  ],
}
```

## Artwork Image Guidelines

### Resolution

- **Large paintings**: 2400x2400px (max)
- **Small paintings**: 1200x1200px (max)
- **Thumbnails**: Auto-generated by Next.js

### File Size

- Original: < 2MB (JPEG/PNG)
- After optimization: < 500KB

### Aspect Ratios

Maintain consistent aspect ratios:
- Square: 1:1
- Portrait: 3:4
- Landscape: 4:3

## Uploading to Supabase Storage

### Best Practices

1. **Name files descriptively**:
   ```
   artwork-title-2024-01.jpg
   ```

2. **Organize in folders**:
   ```
   artworks/
   ├── large-paintings/
   ├── small-paintings/
   └── mixed-media/
   ```

3. **Set proper permissions**:
   ```sql
   -- Public read access for artwork images
   CREATE POLICY "Public artwork images"
   ON storage.objects FOR SELECT
   USING (bucket_id = 'artworks');
   ```

## Optimization Tools

### Before Upload

1. **ImageOptim** (Mac)
   - Drag and drop to compress
   - Lossless optimization

2. **Squoosh** (Web-based)
   - https://squoosh.app
   - Compare formats side-by-side

3. **Sharp CLI** (Command line)
   ```bash
   npm install -g sharp-cli
   sharp -i input.jpg -o output.jpg -q 85
   ```

### Batch Processing Script

Create `scripts/optimize-images.js`:
```javascript
const sharp = require('sharp')
const fs = require('fs').promises
const path = require('path')

async function optimizeImages(inputDir, outputDir) {
  const files = await fs.readdir(inputDir)
  
  for (const file of files) {
    if (!file.match(/\.(jpg|jpeg|png)$/i)) continue
    
    const input = path.join(inputDir, file)
    const output = path.join(outputDir, file.replace(/\.\w+$/, '.webp'))
    
    await sharp(input)
      .resize(2400, 2400, { fit: 'inside', withoutEnlargement: true })
      .webp({ quality: 85 })
      .toFile(output)
    
    console.log(`Optimized: ${file}`)
  }
}

// Usage: node scripts/optimize-images.js
optimizeImages('./raw-images', './optimized-images')
```

## CDN Setup (Optional)

For better performance, consider using a CDN:

### Cloudflare Images

1. Sign up for Cloudflare
2. Enable Image Resizing
3. Update image URLs to use Cloudflare

### Supabase CDN

Supabase automatically serves images through their CDN. No additional setup needed.

## Performance Tips

### 1. Use Appropriate Sizes

```jsx
import Image from 'next/image'

<Image
  src={artwork.image}
  alt={artwork.title}
  width={600}
  height={600}
  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
/>
```

### 2. Preload Critical Images

For hero images:
```jsx
<link
  rel="preload"
  as="image"
  href="/hero-image.jpg"
  imageSrcSet="/hero-image.webp 1x, /hero-image-2x.webp 2x"
/>
```

### 3. Lazy Load Below the Fold

Next.js Image component lazy loads by default, but you can control it:
```jsx
<Image
  src={artwork.image}
  loading="lazy"  // or "eager" for above-the-fold
  priority={false}  // set to true for LCP images
/>
```

## Monitoring Image Performance

### Key Metrics

- **LCP (Largest Contentful Paint)**: < 2.5s
- **Image Load Time**: < 1.5s
- **Total Page Weight**: < 3MB

### Tools

1. **Lighthouse** (Chrome DevTools)
   - Performance score
   - Image optimization suggestions

2. **WebPageTest**
   - Detailed waterfall
   - Image analysis

3. **Chrome DevTools Network Tab**
   - Monitor actual file sizes
   - Check format delivery

## Accessibility

Always include alt text:
```jsx
<Image
  src={artwork.image}
  alt={`${artwork.title} by Dalingcebo, ${artwork.year}, ${artwork.medium}`}
/>
```

## Troubleshooting

### Images Not Loading

1. Check Supabase bucket permissions
2. Verify remote pattern in next.config.ts
3. Check CORS settings

### Slow Image Loading

1. Reduce image dimensions
2. Increase compression
3. Enable CDN
4. Check network speed

### Blurry Images

1. Increase quality setting
2. Provide higher resolution source
3. Check device pixel ratio handling

## Maintenance

- Audit image sizes monthly
- Remove unused images
- Update compression settings as browsers improve
- Monitor storage costs
